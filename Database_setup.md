# Databases

A collection is a table. A document is an entry. A document works as a key-value pair. A key-value pair is a field.

- Collections:
  - [users](#users)
    - store user information
  - [tutors](#tutors)
    - stores subject tutor information for query efficiency
  - [events](#events)
    - stores past, upcoming, and ongoing events
  - [messages](#messages)
    - stores messages between users

## users
- fields:
  - uid: string
    - unique identifier for each user, use FireAuth uid as document id
  - name: string
    - name of user
  - year: string
    - year of user
    - Possible values: [Freshman, Sophomore, Junior, Senior, Graduate, PhD, PostDoc, Professor, Other]
  - major: string
    - major of user
  - minor: Null or string
    - minor of user
  - about: string
    - user description
  - availableCourses: string
    - Courses that the user is available to tutor, split by comma.
  - taughtCount: int
    - number of courses taught
  - ratings: int
    - rating sum of user
  - imagePath: string
    - the url of the user profile pic
  - fullPath: string
    - the relative fullPath of the image in the buckets
  - balance: int
    - the number of balance left for the user
- special notes:
  - for ease of rating calculating, the database holds, the rating sum of the user and total course count. The `average rating` should be calculated using `ratings / taughtCount`.
  - user profile picture storage hasn't realize yet.
  - model defination file: [User](/lib/model/user.dart)

## tutors
- fields:
  - uid: string
    - unique identifier for each user, auto-generated by firebase
  - tutor_uid: string, foreign key
    - unique identifier for each tutor
  - Course: string
    - course name or course code
- special notes:
  - this collection is used to store the tutor information for query efficiency. The `tutor_uid` is the foreign key to the `users` collection.
  - Each time the `availableCourses` is updated, all documents in this collection with the same `tutor_uid` should be deleted and re-inserted.

## events
- fields:
  - uid: string
    - unique identifier for each event, auto-generated by firebase
  - tutor_uid: string, foreign key
    - unique identifier for each tutor
  - student_uid: string, foreign key
    - unique identifier for each student
  - course: string
    - course name or course code
  - time: string
    - time of the event
  - location: string
    - location of the event
  - status: string
    - status of the event
    - Possible values: [Upcoming, Ongoing, Past]
  - student rating: int
    - student rating of the event
  - ~~tutor rating: int~~
    - ~~tutor rating of the event~~
  - cost: int
    - cost of the event
  - student review: string
    - student review of the event
  - ~~tutor review: string~~
    - ~~tutor review of the event~~
- special notes:
  - the `tutor_uid` and `student_uid` are the foreign keys to the `users` collection.
  - the `student rating` and `student review` should be updated when the event is marked as `Past`.
  - the `tutor rating` and `tutor review` is the feedback from tutor to the student. It's a *__wanted__* feature.

## messages
  maintain by other team members. Should at lease has a auto generated `uid` and `event_uid`.

## timeslots
  - fields:
    - uid: string
      - document ID, auto generate by firestore
    - user_uid: string
      - the user uid in FireAuth and `user` collectionn
    - start_time: Timestamp
      - one start timestamp of the time slot
    - end_time: Timestamp
      - one end timestamp of the time slot
  - special notes:
    - one user will have multiple time slots. When updated, will delete all current time slots of this user and reinsert everything.

